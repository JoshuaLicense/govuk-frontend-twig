{% macro govukAccordion(params) %}
{% set id = params.id %}
{% set headingLevel = params.headingLevel ?? 2 %}

<div class="govuk-accordion {%- if params.classes is defined and params.classes is not null %} {{ params.classes }}{% endif -%}" data-module="govuk-accordion" id="{{ id }}"
  {%- if params.hideAllSectionsText ?? false %} data-i18n.hide-all-sections="{{ params.hideAllSectionsText | escape }}"{% endif %}
  {%- if params.hideSectionText ?? false %} data-i18n.hide-section="{{ params.hideSectionText | escape }}"{% endif %}
  {%- if params.hideSectionAriaLabelText ?? false %} data-i18n.hide-section-aria-label="{{ params.hideSectionAriaLabelText | escape }}"{% endif %}
  {%- if params.showAllSectionsText ?? false %} data-i18n.show-all-sections="{{ params.showAllSectionsText | escape }}"{% endif %}
  {%- if params.showSectionText ?? false %} data-i18n.show-section="{{ params.showSectionText | escape }}"{% endif %}
  {%- if params.showSectionAriaLabelText ?? false %} data-i18n.show-section-aria-label="{{ params.showSectionAriaLabelText | escape }}"{% endif %}
  {%- for attribute, value in params.attributes ?? [] %} {{attribute}}="{{value}}"{% endfor %}>
  {% for item in params.items ?? [] %}
    {% if item %}
      <div class="govuk-accordion__section {%- if item.expanded ?? false %} govuk-accordion__section--expanded{% endif %}">
        <div class="govuk-accordion__section-header">
          <h{{ headingLevel }} class="govuk-accordion__section-heading">
            <span class="govuk-accordion__section-button" id="{{ id }}-heading-{{ loop.index }}">
              {{ item.heading.html is defined and item.heading.html is not null ? item.heading.html | raw : item.heading.text }}
            </span>
          </h{{ headingLevel }}>
          {% if item.summary.html is defined or item.summary.text is defined %}
            <div class="govuk-accordion__section-summary govuk-body" id="{{ id }}-summary-{{ loop.index }}">
              {{ item.summary.html is defined and item.summary.html is not null ? item.summary.html | raw : item.summary.text }}
            </div>
          {% endif %}
        </div>
        <div id="{{ id }}-content-{{ loop.index }}" class="govuk-accordion__section-content" aria-labelledby="{{ id }}-heading-{{ loop.index }}">
          {% if item.content.html is defined and item.content.html is not null %}
            {{ item.content.html | raw }}
          {% elseif item.content.text is defined and item.content.text is not null %}
            <p class="govuk-body">{{ item.content.text }}</p>
          {% endif %}
        </div>
      </div>
    {% endif %}
  {% endfor %}
</div>
{% endmacro %}
